# Формат EXTM3U

Формат **EXTM3U** появился как расширение формата m3u широко применяемый для формирования плейлиста со 
списком аудиозаписей. От этого и название – extended m3u. Изначально этот формат использовался в медиапроигрывателе Winamp,
но со временем обрел высокую популярность, и его со временем начали поддерживать почти все проигрыватели. Формальной 
спецификации для формата M3U нет, это стандарт де-факто.

Плейлист в формате EXTM3U представляет из себя текстовый файл с расширением m3u или m3u8. Изначальной кодировкой плейлистов
была Latin-1. Но уже довольно скоро все перешли на кодировку UTF-8 без BOM. 

Пример содержимого файла в формате EXTM3U:

    #EXTM3U
    #PLAYLIST:Playlist1
    #EXTINF:-1 tvg-name="Канал 1" tvg-logo="http://site.domain/channel1_logo.png", Канал 1
    #EXTGRP:Группа1
    http://site.domain/channel1
    #EXTINF:-1 tvg-name="Канал 2" tvg-logo="http://site.domain/channel2_logo.png", Канал 2
    #EXTGRP:Группа1
    http://site.domain/channel2
    #EXTINF:-1 tvg-name="Канал 3" tvg-logo="http://site.domain/channel3_logo.png", Канал 3
    #EXTGRP:Группа2
    http://site.domain/channel3


### #EXTM3U
    
Формат:

    #EXTM3U [<attribute-list>]
    
Директива #EXTM3U – это обязательный заголовок файла, сообщает устройству, что это плейлист в формате EXTM3U. Должена быть
первой строкой в плейлисте. 

Также рядом с ней могут указываться дополнительные аттрибуты, такие как ссылка на файл с TV-программой (в случае если
плейлист используется для просмотра ТВ). Аттрибуты не являются обязательными.

Атрибуты плейлиста, указываются в строке после директивы #EXTM3U в виде пар ' ключ="значение" '.

Доступные аттрибуты:

    url-tvg – ссылка на файл тв-программы 
    cache – время кеширования
    deinterlace – деинтерлейс, 0, 1 = Blend, 2 = Mean
    aspect-ratio – соотношение сторон, None, 4:3, 16:9
    crop – обрезка изображения WxH+X+Y (например, 690x550+15+10)
    refresh – периодичность обновления

Пример использования: 
    
    #EXTM3U url-tvg="http://playlistserver/xmltv.xml.gz"

### #PLAYLIST

Формат:

    #PLAYLIST: <SomeName> 

Директива #PLAYLIST задает имя плейлиста. Не является обязательной.

### #EXTGRP

Формат:

    #EXTGRP: <GroupTitle> 

Директива #EXTGRP начинает группировку последующих медиа ресурсов и задает имя группе. Все последующие
медиа фрагменты будут относиться к этой группе до тех пор, пока она не будет изменена следующей директивой #EXTGRP.
    
Если в аттрибутах медиа ресурса (канала) присутствует аттрибут 'group-title', то для имени группы будет использован он,
а не имя, установленное #EXTGRP, но только для этого медиа ресурса. 

### #EXTINF

Формат:

    #EXTINF:<duration>[<attribute-list>],[<title>]

Директива #EXTINF описывает медиа фрагменты (каналы, треки, видеофайлы, и т.д.). 

Параметр 'duration' является обязательным и описывается числом с плавающей точкой или целым числом. Задает продолжительность
медиа сегмента в секундах. Для потоковых медиа сегментов обычно указывается -1 или 0.

Аттрибуты и имя канала не обязательны.

Формат аттрибутов:

    AttributeName=["]AttributeValue["]

Согласно RFC8216 имена аттрибутов должны содержать только символы [A..Z], [0..9] и '-'. Т.е. только прописные латинские символы,
цифры и знак '-'. Но далеко не все сервисы и плееры следуют этому стандарту, допускается применение строчных латинских символов, 
пробелов между именем атрибута и знаком '='.  

Доступные атрибуты каналов:

    id – уникальный идентификатор канала
    tvg-id – уникальный идентификатор канала в файле программы, если используется например формат XMLTV
    group_id – идентификатор группы каналов
    group-title – наименование группы каналов
    tvg-shift – указывает на смещение расписания программы, принимает значения -1,-2,0,1,2,.. и так далее.
    tvg-name – наименование канала в файле программы, используется в основном при использовании программы в формате JTV
    tvg-logo – ссылка на логотип канала
    audio-track – указывает какую звуковую дорожку использовать, например en или ru
    audio-track-num – указывает какой номер звуковой дорожки использовать, начиная с нуля, например 0,1,2 и так далее
    censored – указывает на то что канал требуется защитить родительским контролем, если такой присутствует в устройстве, может принимать значения 0 и 1

Директива #EXTINF сообщает о том, что в плейлисте дальше последуют данные о треке/канале

    #EXTINF:-1 tvg-name="Канал 1" tvg-logo="http://site.domain/channel1_logo.png", Канал 1

Далее, следующая строка – это сама ссылка на медиаисточник, например поток IPTV или путь к имени файла если это музыкальный трек. 

Пример:
    
    #EXTINF:-1, Some iptv Channal
    http://site.domain/channel1/video.ts
    #EXTINF:-1 tvg-id=234 tvg-name="Some iptv Channal2", Some iptv Channal2
    http://site.domain/channel2/video.ts




Разные медиаустройства могут использовать разный набор параметров